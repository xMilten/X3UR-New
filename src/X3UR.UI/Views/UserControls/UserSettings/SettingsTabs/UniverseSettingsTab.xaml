<UserControl x:Class="X3UR.UI.Views.UserControls.UserSettings.SettingsTabs.UniverseSettingsTab"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:X3UR.UI.Views.UserControls.UserSettings.SettingsTabs"
             xmlns:viewModel="clr-namespace:X3UR.UI.ViewModels.UserSettings.SettingsTab"
             mc:Ignorable="d" 
             Height="Auto" Width="Auto">
    <ScrollViewer HorizontalScrollBarVisibility="Auto"
                  VerticalScrollBarVisibility="Auto"
                  HorizontalAlignment="Stretch"
                  VerticalAlignment="Stretch">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" /> <!-- Map-Einstellungen -->
                <RowDefinition Height="*" />    <!-- Rassentabelle -->
                <RowDefinition Height="Auto" /> <!-- Gesamtstatistik -->
            </Grid.RowDefinitions>
            
            <!-- Map-Einstellungen -->
            <Grid Grid.Row="0" Margin="2">
                <Grid.RowDefinitions>
                    <RowDefinition Height="30" />
                    <RowDefinition Height="30" />
                    <RowDefinition Height="30" />
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="50" />
                    <ColumnDefinition Width="*" MinWidth="100" />
                    <ColumnDefinition Width="40" />
                </Grid.ColumnDefinitions>
                
                <!-- Karte -->
                <Label Grid.Row="0" Grid.Column="0" Content="Karte" FontWeight="Bold" VerticalContentAlignment="Center" HorizontalContentAlignment="Left" />
                <Label Grid.Row="0" Grid.Column="1" Content="Anzahl der möglichen Sektoren:" VerticalContentAlignment="Center" HorizontalContentAlignment="Right" />
                <Label Grid.Row="0" Grid.Column="2" Content="{Binding TotalSectorCount}" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" />

                <!-- Breite -->
                <Label Grid.Row="1" Grid.Column="0" Content="Breite" FontWeight="Bold" VerticalContentAlignment="Center" HorizontalContentAlignment="Left" />
                <Slider Grid.Row="1" Grid.Column="1" Minimum="{Binding MinWidth}" Maximum="{Binding MaxWidth}" TickFrequency="1" IsSnapToTickEnabled="True" Value="{Binding Width, Mode=TwoWay}" VerticalAlignment="Center" />
                <TextBox Grid.Row="1" Grid.Column="2" Text="{Binding Width, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Margin="2" />

                <!-- Höhe -->
                <Label Grid.Row="2" Grid.Column="0" Content="Höhe" FontWeight="Bold" VerticalContentAlignment="Center" HorizontalContentAlignment="Left" />
                <Slider Grid.Row="2" Grid.Column="1" Minimum="{Binding MinHeight}" Maximum="{Binding MaxHeight}" TickFrequency="1" IsSnapToTickEnabled="True" Value="{Binding Height, Mode=TwoWay}" VerticalAlignment="Center" />
                <TextBox Grid.Row="2" Grid.Column="2" Text="{Binding Height, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Margin="2" />
            </Grid>

            <!-- Rassentabelle -->
            <Grid Grid.Row="1">
                <Grid.RowDefinitions>
                    <RowDefinition Height="30" />
                    <RowDefinition Height="30" />
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="110" />
                    <ColumnDefinition Width="2.7*" />
                    <ColumnDefinition Width="2.5*" />
                    <ColumnDefinition Width="2.5*" />
                </Grid.ColumnDefinitions>
                
                <!-- Header -->
                <Label Grid.Row="0" Grid.Column="0" Content="Rasse" FontWeight="Bold" />
                <Label Grid.Row="0" Grid.Column="1" Content="Größe" FontWeight="Bold" />
                <Label Grid.Row="0" Grid.Column="2" Content="Cluster-Anz." FontWeight="Bold" />
                <Label Grid.Row="0" Grid.Column="3" Content="Cluster-Grö." FontWeight="Bold" />

                <!-- Datenzeilen per ItemsControl -->
                <ItemsControl Grid.Row="1" Grid.RowSpan="11" ItemsSource="{Binding RaceSettings}">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <Grid Margin="1">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="110"/>
                                    <ColumnDefinition Width="2.7*"/>
                                    <ColumnDefinition Width="2.5*"/>
                                    <ColumnDefinition Width="2.5*"/>
                                </Grid.ColumnDefinitions>
                                <!-- Spalte 1: Checkbox, Farbquadrat, Name -->
                                <StackPanel Grid.Column="0" Orientation="Horizontal">
                                    <CheckBox IsChecked="{Binding IsActive}"/>
                                    <Rectangle Width="24" Height="24" Fill="{Binding Color}" Margin="2,0"/>
                                    <Label Content="{Binding Name}" VerticalAlignment="Center"/>
                                </StackPanel>
                                <!-- Spalte 2: Size Slider + Eingabe + Anteil -->
                                <StackPanel Grid.Column="1" Orientation="Horizontal">
                                    <Slider Width="100" Minimum="1" Maximum="{Binding MaxSize}" Value="{Binding MaxSize, Mode=TwoWay}" TickFrequency="1" IsSnapToTickEnabled="True"/>
                                    <TextBox Width="40" Text="{Binding MaxSize, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Margin="2,0"/>
                                    <Label Content="{Binding SizePercentage, StringFormat=P0}" VerticalAlignment="Center"/>
                                </StackPanel>
                                <!-- Spalte 3: ClusterCount -->
                                <StackPanel Grid.Column="2" Orientation="Horizontal">
                                    <Slider Width="100" Minimum="1" Maximum="{Binding MaxClusters}" Value="{Binding MaxClusters, Mode=TwoWay}" TickFrequency="1" IsSnapToTickEnabled="True"/>
                                    <TextBox Width="40" Text="{Binding MaxClusters, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Margin="2,0"/>
                                </StackPanel>
                                <!-- Spalte 4: ClusterSize -->
                                <StackPanel Grid.Column="3" Orientation="Horizontal">
                                    <Slider Width="100" Minimum="1" Maximum="{Binding MaxClusterSize}" Value="{Binding MaxClusterSize, Mode=TwoWay}" TickFrequency="1" IsSnapToTickEnabled="True"/>
                                    <TextBox Width="40" Text="{Binding MaxClusterSize, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Margin="2,0"/>
                                </StackPanel>
                            </Grid>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </Grid>

            <!-- Gesamtstatistik -->
            <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Left">
                <Label Content="Sektoren insgesamt:" />
                <Label Content="{Binding TotalRaceSize}" />
                <Label Content="{Binding RaceSizePercentage, StringFormat=P0}"/>
            </StackPanel>
            
        </Grid>
    </ScrollViewer>
</UserControl>
